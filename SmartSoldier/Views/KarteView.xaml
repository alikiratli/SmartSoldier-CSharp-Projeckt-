<UserControl x:Class="SmartSoldier.Views.KarteView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Karte Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Karte und Navigation" FontSize="18" FontWeight="Bold" Margin="0,0,20,0" />
            <Button x:Name="btnCurrentLocation" Content="⚪ Aktuelle Position" Width="150" Click="BtnCurrentLocation_Click" />
            <Button x:Name="btnSetDestination" Content="⚫ Ziel setzen" Width="120" Margin="10,0,0,0" Click="BtnSetDestination_Click" />
        </StackPanel>
        
        <!-- Karte Canvas mit einfacher Simulation -->
        <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="2" Background="LightGreen">
            <Canvas x:Name="MapCanvas" Background="LightBlue">
                <!-- Straßen als Linien -->
                <Line x:Name="road1" X1="0" Y1="100" X2="400" Y2="100" Stroke="Gray" StrokeThickness="8"/>
                <Line x:Name="road2" X1="200" Y1="0" X2="200" Y2="300" Stroke="Gray" StrokeThickness="8"/>
                <Line x:Name="road3" X1="100" Y1="200" X2="400" Y2="200" Stroke="Gray" StrokeThickness="6"/>
                
                <!-- Aktuelle Position (blaue Ellipse) -->
                <Ellipse x:Name="currentPos" Width="20" Height="20" Fill="Blue" 
                         Canvas.Left="180" Canvas.Top="90" Stroke="White" StrokeThickness="3">
                    <Ellipse.RenderTransform>
                        <ScaleTransform x:Name="posScale" ScaleX="1" ScaleY="1" CenterX="10" CenterY="10"/>
                    </Ellipse.RenderTransform>
                    <Ellipse.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                                    <DoubleAnimation Storyboard.TargetName="posScale"
                                                   Storyboard.TargetProperty="ScaleX"
                                                   From="1" To="1.3" Duration="0:0:1"/>
                                    <DoubleAnimation Storyboard.TargetName="posScale"
                                                   Storyboard.TargetProperty="ScaleY"
                                                   From="1" To="1.3" Duration="0:0:1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Ellipse.Triggers>
                </Ellipse>
                
                <!-- Ziel Position (rote Ellipse) -->
                <Ellipse x:Name="destination" Width="16" Height="16" Fill="Red" 
                         Canvas.Left="342" Canvas.Top="192" Stroke="White" StrokeThickness="2"/>
                
                <!-- Navigationsroute (grüne Linie) -->
                <Polyline x:Name="routeLine" Stroke="Lime" StrokeThickness="4" Opacity="0.8"
                          Points="190,100 300,100 300,200 350,200"/>
                
                <!-- Gebäude/Landmarks -->
                <Rectangle Width="40" Height="30" Fill="Brown" Canvas.Left="50" Canvas.Top="120"/>
                <Rectangle Width="35" Height="25" Fill="Brown" Canvas.Left="120" Canvas.Top="50"/>
                <Rectangle Width="30" Height="20" Fill="Brown" Canvas.Left="300" Canvas.Top="250"/>
                
                <!-- Kompass -->
                <Grid Canvas.Left="350" Canvas.Top="20" Width="40" Height="40">
                    <Ellipse Fill="White" Stroke="Black" StrokeThickness="2"/>
                    <TextBlock Text="N" HorizontalAlignment="Center" VerticalAlignment="Top" FontWeight="Bold" Margin="0,2,0,0"/>
                    <Polygon Points="20,8 25,20 20,18 15,20" Fill="Red"/>
                </Grid>
            </Canvas>
        </Border>
        
        <!-- Navigation Info -->
        <StackPanel Grid.Row="2" Orientation="Vertical" Margin="0,10,0,0">
            <TextBlock x:Name="tbNavInfo" Text="Navigation: In 150m rechts abbiegen auf Hauptstraße" 
                       FontSize="14" FontWeight="Bold" Foreground="DarkBlue"/>
            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                <TextBlock Text="Entfernung zum Ziel: " FontSize="12"/>
                <TextBlock x:Name="tbDistance" Text="420m" FontSize="12" FontWeight="Bold" Foreground="Green"/>
                <TextBlock Text=" | Geschätzte Ankunft: " FontSize="12" Margin="20,0,0,0"/>
                <TextBlock x:Name="tbETA" Text="5 Minuten" FontSize="12" FontWeight="Bold" Foreground="Orange"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</UserControl>
